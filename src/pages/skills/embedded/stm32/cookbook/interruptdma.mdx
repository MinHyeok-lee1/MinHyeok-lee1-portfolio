# ⚖️ 인터럽트 vs DMA

## 🚨 인터럽트(Interrupt) 방식

| 항목        | 설명                                                                           |
| :---------- | :----------------------------------------------------------------------------- |
| 동작 방식   | 데이터 한 바이트(혹은 정해진 단위) 받을 때마다 CPU가 인터럽트를 받아 직접 처리 |
| CPU 부하    | 비교적 높음 (데이터 수신/전송할 때마다 CPU가 개입)                             |
| 코드 복잡도 | 간단함 (ISR만 작성하면 끝)                                                     |
| 속도        | 중간 (빠른 편이지만 CPU가 계속 방해받음)                                       |
| 특징        | <li>짧은 데이터 처리에 유리</li> <li>오버헤드 있음</li>                        |
| 예시        | UART로 1바이트씩 받아서 명령 처리                                              |

---

## 🚚 DMA(Direct Memory Access) 방식

| 항목        | 설명                                                                           |
| :---------- | :----------------------------------------------------------------------------- |
| 동작 방식   | 데이터 전송/수신을 CPU 개입 없이 메모리로 바로 복사함                          |
| CPU 부하    | 매우 낮음 (CPU는 데이터 다 끝날 때까지 개입 안 함)                             |
| 코드 복잡도 | 약간 복잡함 (초기 설정, 전송 완료 콜백 핸들링 필요)                            |
| 속도        | 빠름 (CPU를 방해하지 않으니까 전체 시스템 반응성 ↑)                            |
| 특징        | <li>대량 데이터(버퍼 단위) 처리에 최적</li> <li>전송 완료 인터럽트만 처리</li> |
| 예시        | UART로 512바이트 로그 한번에 수신해서 처리                                     |

## 🎯 요약 정리

| 상황                                                | 추천 방식 |
| :-------------------------------------------------- | :-------- |
| 빠르게 한두 바이트 처리, 코드 간단하게 하고 싶을 때 | 인터럽트  |
| 긴 데이터, 대용량 스트림, CPU 부하 줄이고 싶을 때   | DMA       |

---

## 📢 실제 STM32 프로젝트에서는

- UART 작은 명령어 수신 → 인터럽트
- 대량 데이터 (예: 파일, 큰 로그) → DMA
- 경우에 따라 **혼합 사용**도 가능 (ex: 짧은 명령은 인터럽트, 큰 블록은 DMA)

---

## 📋 DMA를 **언제** 쓰고 **언제** 쓰지 말아야 하는가?

| 항목                  | 인터럽트(IT)                  | DMA                                          |
| :-------------------- | :---------------------------- | :------------------------------------------- |
| 데이터 크기           | 작음 (1~2바이트, 짧은 데이터) | 큼 (수십~수백 바이트 이상)                   |
| 데이터 발생 빈도      | 간헐적 (버튼, 키 입력)        | 자주 (센서, 스트리밍 데이터)                 |
| 실시간성 요구         | 매우 빠름 (ms 이내)           | 빠르지만 초기 설정에 딜레이 있음             |
| MCU 부하 (CPU 사용량) | 많아짐 (자주 인터럽트 발생)   | CPU 부하 줄임 (DMA가 복사 담당)              |
| 복잡성                | 간단 (구현 쉬움)              | 복잡 (버퍼 관리, 충돌 주의)                  |
| 예시                  | 키보드 입력, 버튼 처리        | 센서 데이터 수집, 오디오 스트림, 대용량 통신 |

---

## 📈 센서 데이터에서는 DMA를 사용하는 게 맞다?

### ✅ 맞아

센서 데이터는:

- **주기적으로** 들어오고
- **크기도 꽤 많고** (ex. 16바이트, 64바이트 계속)
- **빠르게 계속 들어올 수도** 있음

이런 경우 인터럽트(IT) 방식으로 처리하면

- **매번 인터럽트가 터지고**
- **MCU가 인터럽트에만 매달려서**  
  **다른 작업을 제대로 못함**

**DMA를 쓰면:**

- 데이터 수신은 **자동**으로 메모리에 쌓이고
- CPU는 **그냥 데이터 모일 때만 처리**하면 됨

---

## 🚀 정리

| 상황                                   | 추천 방식        |
| :------------------------------------- | :--------------- |
| 키 입력, 버튼 (적은 데이터, 빠른 반응) | **인터럽트(IT)** |
| 센서, 연속 데이터 스트림 (큰 데이터)   | **DMA**          |

---

## ✨ 한 문장으로 요약

> "**빠른 반응**이 필요한 곳은 인터럽트,  
> **대용량 반복 데이터**는 DMA 사용"

---

## 📦 추가 학습 내용

센서용 DMA를 쓸 때는 **"이중 버퍼 (Double Buffer)"** 개념까지 가면 최고로 부드럽게 동작
